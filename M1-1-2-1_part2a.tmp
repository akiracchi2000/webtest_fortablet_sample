        // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° ---
        let quizData = [];
        let incorrectQuestions = []; // é–“é•ãˆãŸå•é¡Œã‚’æ ¼ç´
        let currentQuestionIndex = 0;
        let score = 0;
        let startTime; // é–‹å§‹æ™‚é–“
        let isSoundOn = true; // åŠ¹æœéŸ³ON/OFF
        let isDarkMode = false; // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ON/OFF
        let isResumeOn = false; // ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ©Ÿèƒ½ON/OFF (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆOFF)
        let currentPenColor = '#000'; // ç¾åœ¨ã®ãƒšãƒ³ã®è‰²
        const synth = window.speechSynthesis;
        let currentUtterance = null;
        let audioCtx = null; // ã‚°ãƒ­ãƒ¼ãƒãƒ«AudioContext

        // --- ã‚­ãƒ£ãƒ³ãƒã‚¹é–¢é€£ ---
        // --- AIã®JSONã‚’å®‰å…¨ã«ãƒ‘ãƒ¼ã‚¹ï¼ˆ\subset ãªã©ã®ä¸æ­£ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’è‡ªå‹•ä¿®å¾©ï¼‰ ---
        function parseAIJsonWithRepair(rawText) {
            if (!rawText) throw new Error("Empty AI response");

            const trimmed = rawText.trim();

            // ä½™è¨ˆãªå‰å¾Œæ–‡ãŒæ··ã–ã£ã¦ã‚‚æœ€åˆã® { ã‹ã‚‰æœ€å¾Œã® } ã‚’æ‹¾ã†
            const match = trimmed.match(/\{[\s\S]*\}/);
            let jsonStr = match ? match[0] : trimmed;

            // ã¾ãšç´ ç›´ã«ãƒ‘ãƒ¼ã‚¹
            try {
                return JSON.parse(jsonStr);
            } catch (e1) {
                // JSONã¨ã—ã¦ç„¡åŠ¹ãªãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã ã‘ã‚’ \\ ã«ä¿®å¾©
                // ä¾‹: "\subset" -> "\\subset"
                let repaired = jsonStr.replace(
                    /\\(?!["\\/bfnrtu]|u[0-9a-fA-F]{4})/g,
                    '\\\\'
                );

                try {
                    return JSON.parse(repaired);
                } catch (e2) {
                    // æœ€çµ‚ä¿é™ºï¼šå…¨éƒ¨ã® \ ã‚’ \\ ã«ï¼ˆå¤šå°‘è’ã„ãŒæ­¢è¡€ã«ãªã‚‹ï¼‰
                    repaired = jsonStr.replace(/\\/g, '\\\\');
                    return JSON.parse(repaired);
                }
            }
        }

        // --- ã‚­ãƒ£ãƒ³ãƒã‚¹é–¢é€£ ---
        // let canvas; // å‰Šé™¤ (å„é–¢æ•°å†…ã§å–å¾—)
        // let ctx;    // å‰Šé™¤ (å„é–¢æ•°å†…ã§å–å¾—)
        // let isDrawing = false; // å‰Šé™¤ (ã‚­ãƒ£ãƒ³ãƒã‚¹ã”ã¨ã«ç®¡ç†)
        let currentTool = 'pen'; // 'pen' or 'eraser'
        let memoHistory = []; // Undoç”¨å±¥æ­´ (ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ¢ç”¨)
        let isPenOnlyMode = true; // ãƒšãƒ³ã®ã¿ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ‘ãƒ¼ãƒ ãƒªã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

        document.addEventListener("DOMContentLoaded", function () {
            initAudioContext(); // ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®åˆæœŸåŒ–æº–å‚™
            initCanvases(); // è¤‡æ•°ã‚­ãƒ£ãƒ³ãƒã‚¹åˆæœŸåŒ–
            setTimeout(resizeCanvases, 100); // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç¢ºå®šå¾Œã«å†èª¿æ•´
            initQuiz();
            // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰è¨­å®šã‚’èª­ã¿è¾¼ã‚€
            const savedDarkMode = localStorage.getItem('darkMode');
            if (savedDarkMode === 'true') {
                isDarkMode = true;
                document.body.classList.add('dark-mode');
                document.getElementById('dark-mode-toggle').textContent = 'â˜€ï¸';
                currentPenColor = '#fff'; // ãƒšãƒ³ã®è‰²ã‚’ç™½ã«è¨­å®š
            }

            // ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ è¨­å®šã‚’èª­ã¿è¾¼ã‚€ (ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–)
            // const savedResume = localStorage.getItem('resumeOn');
            // if (savedResume !== null) {
            //     isResumeOn = (savedResume === 'true');
            // }
            updateResumeButton();

            // å…¨ä½“ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ï¼ˆå·¦ãƒ‘ãƒãƒ«ã¨ãƒ¢ãƒ¼ãƒ€ãƒ«ä»¥å¤–ï¼‰
            document.addEventListener('touchmove', function (e) {
                // å·¦ãƒ‘ãƒãƒ«ã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã€ã¾ãŸã¯ãƒ„ãƒ¼ãƒ«ãƒãƒ¼å†…ã®è¦ç´ ï¼ˆãƒœã‚¿ãƒ³ãªã©ï¼‰ã§ã®æ“ä½œã¯è¨±å¯
                if (!e.target.closest('#left-panel') &&
                    !e.target.closest('.modal-content') &&
                    !e.target.closest('#image-preview-modal') && !e.target.closest('#memo-toolbar')) {
                    e.preventDefault();
                }
            }, { passive: false });


            // --- ç©æ¥µçš„ãªã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆé…å»¶å¯¾ç­–ï¼‰ ---
            document.addEventListener('touchstart', function (e) {
                if (e.target.closest('.option-btn') || e.target.closest('#next-btn') || e.target.closest('#results-btn')) {
                    if (isSoundOn) {
                        try {
                            const AudioContext = window.AudioContext || window.webkitAudioContext;
                            if (!audioCtx && AudioContext) {
                                audioCtx = new AudioContext();
                            }
                            if (audioCtx && audioCtx.state === 'suspended') {
                                audioCtx.resume();
                            }
                        } catch (err) {
                            console.error("Audio warmup failed:", err);
                        }
                    }
                }
            }, { passive: true });
        });

        // --- ã‚¯ã‚¤ã‚ºåˆæœŸåŒ– ---
        function initQuiz() {
            // KaTeXè¨­å®š
            const katexDelimiters = [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ];
            const renderMath = () => {
                if (window.renderMathInElement) {
                    renderMathInElement(document.body, { delimiters: katexDelimiters, throwOnError: false });
                } else {
                    setTimeout(renderMath, 100);
                }
            };
            renderMath();

            // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ (window.QUIZ_DATA from M1-1-1-1QD.js) (æ³¨æ„: ã“ã“ã¯å‘¼ã³å‡ºã—å…ƒã®HTMLã§èª­ã¿è¾¼ã¾ã‚ŒãŸå¤‰æ•°ã‚’ä½¿ã†ã€‚M1-1-2-1QD.jsãŒQUIZ_DATAã‚’å®šç¾©ã—ã¦ã„ã‚‹ã¯ãš)
            let allData = [];
            if (window.QUIZ_DATA) {
                allData = window.QUIZ_DATA;
            } else if (typeof allQuizData !== 'undefined') {
                allData = allQuizData; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            }

            if (!allData || allData.length === 0) {
                document.getElementById('question-text').innerText = "å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚";
                return;
            }

            // ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ©Ÿèƒ½ï¼šä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ç¢ºèª
            const urlParams = new URLSearchParams(window.location.search);
            const isReset = urlParams.get('reset') === 'true';

            if (isReset) {
                // index.htmlã‹ã‚‰æ¥ãŸå ´åˆãªã©ã¯ãƒªã‚»ãƒƒãƒˆï¼ˆç¢ºèªãªã—ã§æœ€åˆã‹ã‚‰ï¼‰
                // URLã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦ã€ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã¯ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ãŒåŠ¹ãã‚ˆã†ã«ã™ã‚‹
                const newUrl = window.location.pathname + window.location.hash;
                window.history.replaceState(null, '', newUrl);
            } else if (isResumeOn) {
                const savedData = localStorage.getItem('quiz_progress_M1-1-2-1');
                if (savedData) {
                    if (confirm("å‰å›ã®ç¶šãã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ")) {
                        restoreProgress(JSON.parse(savedData));
                        return;
                    } else {
                        localStorage.removeItem('quiz_progress_M1-1-2-1'); // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸã‚‰å‰Šé™¤
                    }
                }
            }

            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦10å•æŠ½å‡º
            const shuffled = [...allData].sort(() => 0.5 - Math.random());
            quizData = shuffled.slice(0, 10);

            startTime = Date.now(); // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
            loadQuestion();


        }

        // --- ã‚¯ã‚¤ã‚ºãƒ­ã‚¸ãƒƒã‚¯ ---
        function loadQuestion() {
            const quizContainer = document.getElementById('quiz-container');
            const resultsContainer = document.getElementById('results-container');
            const feedbackEl = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');
            const resultsBtn = document.getElementById('results-btn');
            const optionsContainer = document.getElementById('options-container');
            const showOptionsBtn = document.getElementById('show-options-btn');
            const questionNumberEl = document.getElementById('question-number');
            const questionTextEl = document.getElementById('question-text');

            if (currentQuestionIndex >= quizData.length) return;

            // ãƒªã‚»ãƒƒãƒˆ
            feedbackEl.style.display = 'none';
            nextBtn.style.display = 'none';
            resultsBtn.style.display = 'none';
            document.getElementById('answer-btn').style.display = 'block';
            document.getElementById('analyzing-indicator').style.display = 'none';

            // ãƒ¡ãƒ¢ã¯æ¶ˆã•ãªã„ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‰ã®è¨ˆç®—ã‚’æ®‹ã—ãŸã„ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ï¼‰
            clearMemo();
            clearAnswerPad(); // è§£ç­”æ¬„ã‚¯ãƒªã‚¢

            // ãƒ¡ãƒ¢ã®ã€Œå•é¡Œã‚’è¡¨ç¤ºã€ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('memo-question-overlay').style.display = 'none';
            document.getElementById('btn-toggle-question').classList.remove('active');

            updateProgressAndScore();
            saveProgress(); // é€²è¡ŒçŠ¶æ³ã‚’ä¿å­˜

            const currentQuestion = quizData[currentQuestionIndex];
            questionNumberEl.textContent = `å•é¡Œ ${currentQuestionIndex + 1} / ${quizData.length}`;
            questionTextEl.innerHTML = currentQuestion.question;

            // ãƒ¡ãƒ¢ãƒ‘ãƒƒãƒ‰ä¸Šã®å•é¡Œæ–‡æ›´æ–°
            document.getElementById('memo-question-overlay').innerHTML = `<strong>å•é¡Œ ${currentQuestionIndex + 1}:</strong><br>${currentQuestion.question}`;

            renderAllMath();
        }


        // --- ä¸æ­£è§£æ™‚ã®åˆ†å²ï¼ˆã‚‚ã†ä¸€åº¦è§£ãï¼æ­£è§£ã‚’æ•™ãˆã¦ï¼‰ ---
        let pendingAIResult = null; // { questionIndex, recognizedAnswer, feedback }

        // --- åŠ±ã¾ã—ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆæ°—æŒã¡ã‚ˆã•UPï¼‰ ---
        const ENCOURAGEMENTS = [
            "OKï¼ä»Šã®æ°—ã¥ãã‚’æ´»ã‹ã—ã¦ã‚‚ã†ä¸€åº¦ã„ã“ã†ã€‚",
            "ãƒŠã‚¤ã‚¹åˆ¤æ–­ã€‚ã“ã“ã§ã‚„ã‚Šç›´ã›ã‚‹ã®ãŒå¼·ã„ã€‚",
            "å¤§ä¸ˆå¤«ã€‚1å›ç›®ã§æ°—ã¥ã‘ãŸã®ãŒåç©«ï¼",
            "è½ã¡ç€ã„ã¦ã„ã‘ã°å¿…ãšå–ã‚Œã‚‹ã€‚",
            "ä»Šã®ãƒŸã‚¹ã¯ä¼¸ã³ã—ã‚ã€‚æ¬¡ã§å›åã—ã‚ˆã†ã€‚",
            "ã„ã„ã­ã€‚ã“ã“ã‹ã‚‰ãŒæœ¬ç•ªã€‚",
            "æ›¸ãç›´ã—ã¦ã¿ã‚ˆã†ã€‚ç­”ãˆã«è¿‘ã¥ã„ã¦ã‚‹ã‚ˆã€‚"
        ];

        function showEncouragement() {
            const el = document.getElementById("encouragement-under-question");
            if (!el) return;
            const msg = ENCOURAGEMENTS[Math.floor(Math.random() * ENCOURAGEMENTS.length)];
            el.textContent = msg;
            el.style.display = "block";
        }

        function hideEncouragement() {
            const el = document.getElementById("encouragement-under-question");
            if (!el) return;
            el.style.display = "none";
            el.textContent = "";
        }

        function showWrongDecisionUI(currentQuestion, result) {
            const feedbackEl = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');
            const resultsBtn = document.getElementById('results-btn');
            const answerBtn = document.getElementById('answer-btn');

            nextBtn.style.display = 'none';
            resultsBtn.style.display = 'none';
            answerBtn.style.display = 'none';

            pendingAIResult = {
                questionIndex: currentQuestionIndex,
                recognizedAnswer: result.recognizedAnswer || '',
                feedback: result.feedback || ''
            };

            feedbackEl.className = 'incorrect-feedback';
            feedbackEl.innerHTML = `
                <div class="ai-banner">ğŸ¤–AIã‚«ã‚¬ãƒ¯å…ˆç”ŸğŸ¤–ã®è§£ç­”checkâœ…</div><br>
                <span style="color: var(--incorrect-color);"><strong>ä»Šå›ã¯ä¸æ­£è§£ã§ã—ãŸã€‚</strong></span><br>
                ã‚ãªãŸã®è§£ç­”: ${pendingAIResult.recognizedAnswer || '(èª­ã¿å–ã‚Šä¸å¯)'}<br>
                <div class="wrong-decision-area">
                    <button class="tool-btn ai-btn wrong-decision-btn" onclick="retryCurrentQuestion()">ğŸ” ã‚‚ã†ä¸€åº¦è§£ã</button>
                    <button class="tool-btn ai-btn wrong-decision-btn" onclick="revealCorrectWithAI()">âœ… æ­£è§£ã‚’æ•™ãˆã¦ï¼AIã‚«ã‚¬ãƒ¯å…ˆç”Ÿ</button>
                </div>
                <div class="wrong-decision-note">â€»ã€Œã‚‚ã†ä¸€åº¦è§£ãã€ã‚’é¸ã¶ã¨ï¼Œãƒ¡ãƒ¢ã‚’æ¶ˆã—ã¦è§£ãç›´ã›ã¾ã™ã€‚</div>
            `;
            feedbackEl.style.display = 'block';
            renderAllMath();
        }

        function retryCurrentQuestion() {
            pendingAIResult = null;

            clearMemo();


            const feedbackEl = document.getElementById('feedback');
            const answerBtn = document.getElementById('answer-btn');
            const indicator = document.getElementById('analyzing-indicator');
            const nextBtn = document.getElementById('next-btn');
            const resultsBtn = document.getElementById('results-btn');

            feedbackEl.style.display = 'none';
            indicator.style.display = 'none';
            nextBtn.style.display = 'none';
            resultsBtn.style.display = 'none';

            answerBtn.textContent = "ğŸ¤–AIã‚«ã‚¬ãƒ¯å…ˆç”ŸğŸ¤–ã«æ·»å‰Šã—ã¦ã‚‚ã‚‰ã†";
            answerBtn.style.display = 'block';

            showEncouragement();
        }

        function revealCorrectWithAI() {
            if (!pendingAIResult) return;

            const feedbackEl = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');
            const resultsBtn = document.getElementById('results-btn');

            const q = quizData[pendingAIResult.questionIndex] || quizData[currentQuestionIndex];

            if (!incorrectQuestions.includes(q)) {
                incorrectQuestions.push(q);
            }

            let html = `
                <div class="ai-banner">ğŸ¤–AIã‚«ã‚¬ãƒ¯å…ˆç”ŸğŸ¤–ã®è§£ç­”checkâœ…</div><br>
                <span style="color: var(--incorrect-color);"><strong>ä»Šå›ã¯ä¸æ­£è§£ã§ã—ãŸã€‚</strong></span><br>
                ã‚ãªãŸã®è§£ç­”: ${pendingAIResult.recognizedAnswer || '(èª­ã¿å–ã‚Šä¸å¯)'}<br>
                <strong>æ­£è§£: ${q.answer}</strong><br><br>
            `;

            if (pendingAIResult.feedback) {
                html += `${pendingAIResult.feedback}<br>`;
            }

            html += `<hr><div class="explanation-banner">è§£èª¬</div><br>${q.rationale || ""}`;

            feedbackEl.className = 'incorrect-feedback';
            feedbackEl.innerHTML = html;
            feedbackEl.style.display = 'block';
            renderAllMath();

            if (pendingAIResult.questionIndex < quizData.length - 1) {
                nextBtn.style.display = 'block';
                resultsBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'none';
                resultsBtn.style.display = 'block';
            }

            pendingAIResult = null;

            saveProgress();
            updateProgressAndScore();
        }

        // --- ã‚­ãƒ£ãƒ³ãƒã‚¹ç”»åƒå–å¾—ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ (AIãŠåŠ©ã‘ç”¨: ç™½èƒŒæ™¯ãƒ»é»’æ–‡å­—ãƒ»ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°) ---
        function getCanvasImageBase64(canvasElement, scale = 1) {
            const width = canvasElement.width;
            const height = canvasElement.height;
            const ctx = canvasElement.getContext('2d');

            // 1. å…ƒã®ãƒ”ã‚¯ã‚»ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;

            let minX = width, minY = height, maxX = 0, maxY = 0;
            let hasPixels = false;

            // 2. ãƒ”ã‚¯ã‚»ãƒ«æ“ä½œ & ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹æ¤œå‡º
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const i = (y * width + x) * 4;
                    const alpha = data[i + 3];

                    if (alpha > 50) { // æç”»ã‚ã‚Š
                        data[i] = 0;     // R -> é»’
                        data[i + 1] = 0; // G -> é»’
                        data[i + 2] = 0; // B -> é»’
                        data[i + 3] = 255; // å®Œå…¨ä¸é€æ˜

                        if (x < minX) minX = x;
                        if (x > maxX) maxX = x;
                        if (y < minY) minY = y;
                        if (y > maxY) maxY = y;
                        hasPixels = true;
                    } else {
                        data[i + 3] = 0; // é€æ˜
                    }
                }
            }

            if (!hasPixels) {
                // ç™½ç´™ã®å ´åˆã¯ãã®ã¾ã¾è¿”ã™ï¼ˆå¾Œç¶šã®åˆ¤å®šã§å¼¾ã‹ã‚Œã‚‹ã¯ãšï¼‰
                return canvasElement.toDataURL('image/png').split(',')[1];
            }

            // 3. ä½œæ¥­ç”¨ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œã‚‹ï¼ˆé»’æ–‡å­—ã®ã¿ï¼‰
            const workCanvas = document.createElement('canvas');
            workCanvas.width = width;
            workCanvas.height = height;
            const workCtx = workCanvas.getContext('2d');
            workCtx.putImageData(imageData, 0, 0);

            // 4. åˆ‡ã‚ŠæŠœãç¯„å›²ã®è¨ˆç®—ï¼ˆãƒ‘ãƒ‡ã‚£ãƒ³ã‚°è¿½åŠ ï¼‰
            const padding = 20;
            const cropX = Math.max(0, minX - padding);
            const cropY = Math.max(0, minY - padding);
            const cropWidth = Math.min(width, maxX + padding) - cropX;
            const cropHeight = Math.min(height, maxY + padding) - cropY;

            // 5. æå‡ºç”¨ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œã‚‹ï¼ˆåˆ‡ã‚ŠæŠœã„ãŸã‚µã‚¤ã‚ºï¼‰
            const exportCanvas = document.createElement('canvas');
            exportCanvas.width = cropWidth * scale;
            exportCanvas.height = cropHeight * scale;
            const exportCtx = exportCanvas.getContext('2d');

            // èƒŒæ™¯ã‚’ç™½ã§å¡—ã‚Šã¤ã¶ã™
            exportCtx.fillStyle = '#FFFFFF';
            exportCtx.fillRect(0, 0, exportCanvas.width, exportCanvas.height);

            // åˆ‡ã‚ŠæŠœã„ã¦æç”»
            exportCtx.drawImage(
                workCanvas,
                cropX, cropY, cropWidth, cropHeight, // å…ƒç”»åƒã®ç¯„å›²
                0, 0, exportCanvas.width, exportCanvas.height // å‡ºåŠ›å…ˆã®ç¯„å›²
            );

            return exportCanvas.toDataURL('image/png').split(',')[1];
        }
