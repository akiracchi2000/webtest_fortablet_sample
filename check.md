# クイズ校正ツール (check.html) 使い方メモ

## データの読み込み
1. **推奨**: `check.html` の画面内に、お手持ちのQDファイル（`.js`）をドラッグ＆ドロップしてください。
2. または、画面上部の入力欄にファイル名（例: `M1-1-1-1QD.js`）を入力し「ファイルから読み込む」を押してください。

## 校正（ステータス付与）
- 各問題の「チェック済みにする」「要修正にする」ボタンを押すと、状態が保存されます。
- 状態はブラウザ（localStorage）に保存されるため、ページを閉じても維持されますが、他のPCとは共有されません。

## 結果の出力（エクスポート）
「CSV出力」ボタンを押すと、現在の校正状況をファイルに保存できます。
- **形式**: Excel互換HTML（拡張子は `.xls` ですが、中身はHTMLです）
- **注意**: Excelで開く際、「ファイル形式と拡張子が一致しません」という警告が出ますが、**「はい」** を選んで開いてください。
- **色**: 「済」は緑、「要修正」はオレンジで色付けされます。

## 結果の取込（インポート）
保存した `.xls`（または `.csv`）ファイルを読み込んで、校正状態を復元できます。
1. **重要**: 先に、**出力時と同じQDファイル** を読み込んでおいてください。
2. 「結果取込」ボタンを押し、保存したファイルを選択します。
3. 問題番号（問1, 問2...）を基準にマッチングし、ステータス（済/要修正）が反映されます。

> [!WARNING] 注意
> インポートは「問題番号」で行われます。
> もし元のQDファイルの問題順序が変わっていたり、問題が増減している場合、**ズレて反映される** 恐れがあります。
> 必ず「同じファイル」に対してインポートを行ってください。

## データの修正と保存
画面上で問題文や解説を直接修正し、修正済みのデータファイルを作成できます。
1. 各問題の **「編集」** ボタンを押します。
2. 問題文、選択肢（1行1項目）、正解、解説を修正し、 **「保存」** を押します。
    - ※この時点ではブラウザ上の表示が変わるだけで、ファイルは書き変わりません。
3. 修正が終わったら、ヘッダーの **「修正データ保存」** ボタンを押します。
4. `(元のファイル名)_fixed.js` というファイルがダウンロードされます。
5. このファイルを元のファイル名（例：`M1-1-1-1QD.js`）にリネームして上書き保存してください。
